%%{init: {'theme': 'base', 'themeVariables': { 'primaryColor': '#8B5CF6'}}}%%
flowchart TB
    subgraph USERS["ğŸŒ Users"]
        U1[("ğŸ‘¤ Browser")]
        U2[("ğŸ“± Mobile")]
    end

    subgraph CDN["â˜ï¸ CDN / Load Balancer"]
        LB["Cloudflare / AWS ALB<br/>SSL Termination"]
    end

    subgraph FRONTEND_CLUSTER["âš›ï¸ Frontend Containers"]
        FE1["Frontend<br/>Container 1<br/>(Nginx)"]
        FE2["Frontend<br/>Container 2<br/>(Nginx)"]
        FE3["Frontend<br/>Container 3<br/>(Nginx)"]
    end

    subgraph API_GATEWAY["ğŸ”€ API Gateway"]
        NGINX["NGINX<br/>Reverse Proxy"]
    end

    subgraph BACKEND_CLUSTER["â˜• Backend Containers"]
        BE1["Backend<br/>Container 1<br/>(Spring Boot)"]
        BE2["Backend<br/>Container 2<br/>(Spring Boot)"]
        BE3["Backend<br/>Container 3<br/>(Spring Boot)"]
    end

    subgraph DATABASE["ğŸ—„ï¸ Database Layer"]
        DB_PRIMARY[("MySQL Primary<br/>Read/Write")]
        DB_REPLICA[("MySQL Replica<br/>Read Only")]
    end

    USERS -->|"HTTPS :443"| CDN
    CDN --> FRONTEND_CLUSTER
    FRONTEND_CLUSTER -->|"/api/*"| API_GATEWAY
    API_GATEWAY --> BACKEND_CLUSTER
    BACKEND_CLUSTER -->|"JDBC :3306"| DATABASE
    DB_PRIMARY -->|"Replication"| DB_REPLICA

    style CDN fill:#F59E0B,stroke:#D97706
    style FRONTEND_CLUSTER fill:#3B82F6,stroke:#2563EB
    style API_GATEWAY fill:#10B981,stroke:#059669
    style BACKEND_CLUSTER fill:#EF4444,stroke:#DC2626
    style DATABASE fill:#8B5CF6,stroke:#7C3AED
